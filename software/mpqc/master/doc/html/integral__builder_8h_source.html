<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPQC: mpqc/chemistry/qc/lcao/integrals/integral_builder.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPQC
   &#160;<span id="projectnumber">4.0.0-beta.1</span>
   </div>
   <div id="projectbrief">Massively Parallel Electronic Structure platform</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('integral__builder_8h_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">integral_builder.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="integral__builder_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#ifndef MPQC4_SRC_MPQC_CHEMISTRY_QC_INTEGRALS_INTEGRAL_BUILDER_H_</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#define MPQC4_SRC_MPQC_CHEMISTRY_QC_INTEGRALS_INTEGRAL_BUILDER_H_</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="tiledarray_8h.html">tiledarray.h</a>&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pool_8h.html">mpqc/util/misc/pool.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="basis_8h.html">mpqc/chemistry/qc/lcao/basis/basis.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="qc_2lcao_2expression_2formula_8h.html">mpqc/chemistry/qc/lcao/expression/formula.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="screen__base_8h.html">mpqc/chemistry/qc/lcao/integrals/screening/screen_base.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="task__integral__kernels_8h.html">mpqc/chemistry/qc/lcao/integrals/task_integral_kernels.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="task__integrals__common_8h.html">mpqc/chemistry/qc/lcao/integrals/task_integrals_common.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="petite__list_8h.html">mpqc/math/groups/petite_list.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="exception_8h.html">mpqc/util/core/exception.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacempqc.html">mpqc</a> {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">namespace </span>lcao {</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">namespace </span>gaussian {</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tile, <span class="keyword">typename</span> Engine = lib<span class="keywordtype">int</span>2::Engine&gt;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html">   34</a></span>&#160;<span class="keyword">class </span><a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html">IntegralBuilder</a> {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ad62fb6db3c7bc7a89db9aac74138f50e">   36</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ad62fb6db3c7bc7a89db9aac74138f50e">Op</a> = std::function&lt;Tile(TA::TensorD &amp;&amp;)&gt;;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  std::shared_ptr&lt;BasisVector&gt; bases_;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="namespacempqc_1_1lcao_1_1gaussian.html#a1e7d958d02e65d2ec20148f6a70d3b79">ShrPool&lt;Engine&gt;</a> engines_;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  std::shared_ptr&lt;Screener&gt; screen_;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ad62fb6db3c7bc7a89db9aac74138f50e">Op</a> op_;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  std::shared_ptr&lt;const math::PetiteList&gt; plist_;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#a36a168825fbd4247ec136a7e4e1b7ab7">   58</a></span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#a36a168825fbd4247ec136a7e4e1b7ab7">IntegralBuilder</a>(<a class="code" href="namespacempqc_1_1lcao_1_1gaussian.html#a1e7d958d02e65d2ec20148f6a70d3b79">ShrPool&lt;Engine&gt;</a> shr_epool,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                  std::shared_ptr&lt;BasisVector&gt; shr_bases,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                  std::shared_ptr&lt;Screener&gt; screen, <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ad62fb6db3c7bc7a89db9aac74138f50e">Op</a> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ab48277f001f66d509a46761e84933e1d">op</a>,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                  std::shared_ptr&lt;const math::PetiteList&gt; plist =</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                      <a class="code" href="classmpqc_1_1math_1_1_petite_list.html#a4610f62d3211547339fc74f219ff04b2">math::PetiteList::make_trivial</a>())</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      : bases_(<a class="code" href="namespacestd.html">std</a>::move(shr_bases)),</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        engines_(<a class="code" href="namespacestd.html">std</a>::move(shr_epool)),</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        screen_(<a class="code" href="namespacestd.html">std</a>::move(screen)),</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        op_(<a class="code" href="namespacestd.html">std</a>::move(<a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ab48277f001f66d509a46761e84933e1d">op</a>)),</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        plist_(<a class="code" href="namespacestd.html">std</a>::move(plist)) {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    std::size_t N = bases_-&gt;size();</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    TA_ASSERT((N == 2) || (N == 3) || (N == 4));</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ac47d5b2cf0b069a9cb7717b8b3efdf6a">   72</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ac47d5b2cf0b069a9cb7717b8b3efdf6a">~IntegralBuilder</a>() {}</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#aa633ff3dd8fe6951d1de9fbcd4d7f899">   74</a></span>&#160;  Tile <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#aa633ff3dd8fe6951d1de9fbcd4d7f899">operator()</a>(std::vector&lt;std::size_t&gt; <span class="keyword">const</span> &amp;idx, TA::Range range) {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span> op_(<a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ae4ce62e2cabcbdb95afdbf42f3d50081">integrals</a>(idx, std::move(range)));</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ae4ce62e2cabcbdb95afdbf42f3d50081">   78</a></span>&#160;  TA::TensorD <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ae4ce62e2cabcbdb95afdbf42f3d50081">integrals</a>(std::vector&lt;std::size_t&gt; <span class="keyword">const</span> &amp;idx, TA::Range range) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keyword">auto</span> size = bases_-&gt;size();</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">switch</span> (size) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">// Get integral shells</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#abb0ef0fdc99469d480fd911185ea497e">detail::VecArray&lt;2&gt;</a> shellvec_ptrs2;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = 0ul; i &lt; size; ++i) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          <span class="keyword">auto</span> <span class="keyword">const</span> &amp;basis_i = bases_-&gt;operator[](i);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          shellvec_ptrs2[i] = &amp;basis_i.cluster_shells()[idx[i]];</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">// Compute integrals over the selected shells.</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a63a00d2fcba7079aa59feb52ebea79a4">detail::integral_kernel</a>(engines_-&gt;local(), std::move(range),</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                       shellvec_ptrs2, *screen_, *plist_);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="comment">// Get integral shells</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#abb0ef0fdc99469d480fd911185ea497e">detail::VecArray&lt;3&gt;</a> shellvec_ptrs3;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = 0ul; i &lt; size; ++i) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;          <span class="keyword">auto</span> <span class="keyword">const</span> &amp;basis_i = bases_-&gt;operator[](i);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          shellvec_ptrs3[i] = &amp;basis_i.cluster_shells()[idx[i]];</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">// Compute integrals over the selected shells.</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a63a00d2fcba7079aa59feb52ebea79a4">detail::integral_kernel</a>(engines_-&gt;local(), std::move(range),</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                       shellvec_ptrs3, *screen_, *plist_);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">// Get integral shells</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#abb0ef0fdc99469d480fd911185ea497e">detail::VecArray&lt;4&gt;</a> shellvec_ptrs4;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = 0ul; i &lt; size; ++i) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          <span class="keyword">auto</span> <span class="keyword">const</span> &amp;basis_i = bases_-&gt;operator[](i);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          shellvec_ptrs4[i] = &amp;basis_i.cluster_shells()[idx[i]];</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">// Compute integrals over the selected shells.</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a63a00d2fcba7079aa59feb52ebea79a4">detail::integral_kernel</a>(engines_-&gt;local(), std::move(range),</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                       shellvec_ptrs4, *screen_, *plist_);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="stringliteral">&quot;Invalid Size of Basis Sets!! Must be 2 or 3 or 4!! \n&quot;</span>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keyword">template</span> &lt;lib<span class="keywordtype">int</span>2::Operator lib<span class="keywordtype">int</span>2_oper&gt;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  std::array&lt;TA::TensorD, libint2::operator_traits&lt;libint2_oper&gt;::nopers&gt;</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#a57b6fffec281837d11dacc21ff03b02d">  131</a></span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#a57b6fffec281837d11dacc21ff03b02d">integrals</a>(std::vector&lt;std::size_t&gt; <span class="keyword">const</span> &amp;idx, TA::Range range) {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">auto</span> size = bases_-&gt;size();</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">switch</span> (size) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">// get integral shells</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#abb0ef0fdc99469d480fd911185ea497e">detail::VecArray&lt;2&gt;</a> shellvec_ptrs2;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i = 0ul; i &lt; size; ++i) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;          <span class="keyword">auto</span> <span class="keyword">const</span> &amp;basis_i = bases_-&gt;operator[](i);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          shellvec_ptrs2[i] = &amp;basis_i.cluster_shells()[idx[i]];</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">// Compute integrals over the selected shells.</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">return</span> detail::integral_kernel&lt;libint2_oper&gt;(</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            engines_-&gt;local(), std::move(range), shellvec_ptrs2, *screen_,</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            *plist_);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classmpqc_1_1_feature_not_implemented.html">FeatureNotImplemented</a>(<span class="stringliteral">&quot;Only support basis set size = 2!&quot;</span>,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                    __FILE__, __LINE__);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  };</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ab48277f001f66d509a46761e84933e1d">  153</a></span>&#160;  Tile <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ab48277f001f66d509a46761e84933e1d">op</a>(TA::TensorD &amp;&amp;tensor) { <span class="keywordflow">return</span> op_(std::move(tensor)); }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;};</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tile, <span class="keyword">typename</span> Engine = lib<span class="keywordtype">int</span>2::Engine&gt;</div><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html">  157</a></span>&#160;<span class="keyword">class </span><a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html">DirectIntegralBuilder</a></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    : <span class="keyword">public</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html">IntegralBuilder</a>&lt;Tile, Engine&gt;,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keyword">public</span> std::enable_shared_from_this&lt;DirectIntegralBuilder&lt;Tile, Engine&gt;&gt; {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#a1c06b1961a2c7dda97fa5761ffaa75cc">  161</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ad62fb6db3c7bc7a89db9aac74138f50e">Op</a> = <span class="keyword">typename</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ad62fb6db3c7bc7a89db9aac74138f50e">IntegralBuilder&lt;Tile, Engine&gt;::Op</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#aaa4caf00f45d0e3f66cb815904b043bb">  163</a></span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#aaa4caf00f45d0e3f66cb815904b043bb">DirectIntegralBuilder</a>(madness::World &amp;world, <a class="code" href="namespacempqc_1_1lcao_1_1gaussian.html#a1e7d958d02e65d2ec20148f6a70d3b79">ShrPool&lt;Engine&gt;</a> shr_epool,</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                        std::shared_ptr&lt;BasisVector&gt; shr_bases,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                        std::shared_ptr&lt;Screener&gt; screen, <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ad62fb6db3c7bc7a89db9aac74138f50e">Op</a> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ab48277f001f66d509a46761e84933e1d">op</a>,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                        std::shared_ptr&lt;const math::PetiteList&gt; plist)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      : <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html">IntegralBuilder</a>&lt;Tile, <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">Engine</a>&gt;(shr_epool, shr_bases, screen, <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ab48277f001f66d509a46761e84933e1d">op</a>, plist),</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        id_(world.register_ptr(this)) {}</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#aaa4caf00f45d0e3f66cb815904b043bb">DirectIntegralBuilder</a>(<span class="keyword">const</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html">DirectIntegralBuilder</a> &amp;builder) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html">DirectIntegralBuilder</a> &amp;<a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#a6f6fdcedc22f5c8e7209f39e4f253f08">operator=</a>(<span class="keyword">const</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html">DirectIntegralBuilder</a> &amp;builder) =</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keyword">delete</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#a2356f48131a57c708ccdb9cb51aba543">  174</a></span>&#160;  madness::uniqueidT <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#a2356f48131a57c708ccdb9cb51aba543">id</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> id_; }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#a06695fd049af322840dc86f637348cf0">  176</a></span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#a06695fd049af322840dc86f637348cf0">~DirectIntegralBuilder</a>() {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (madness::initialized()) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      madness::World *world = madness::World::world_from_id(id_.get_world_id());</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      world-&gt;unregister_ptr(<span class="keyword">this</span>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keyword">using</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html">IntegralBuilder&lt;Tile, Engine&gt;::operator</a>();</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keyword">using</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html">IntegralBuilder&lt;Tile, Engine&gt;::integrals</a>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keyword">using</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html">IntegralBuilder&lt;Tile, Engine&gt;::op</a>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  madness::uniqueidT id_;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;};</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tile&gt;</div><div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html">  192</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html">DFTaskGemm</a> {</div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">  193</a></span>&#160;  <span class="keyword">typedef</span> Tile <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">result_type</a>;</div><div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ac908fe243db7cd9812edbaddea40c07a">  194</a></span>&#160;  <span class="keyword">typedef</span> Tile <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ac908fe243db7cd9812edbaddea40c07a">first_argument_type</a>;</div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ab10c601159d8c534e2b06fd84621621c">  195</a></span>&#160;  <span class="keyword">typedef</span> Tile <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ab10c601159d8c534e2b06fd84621621c">second_argument_type</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a2d6a2a4b4dc0203d7d014f1a6c060afa">  197</a></span>&#160;  TA::Range <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a2d6a2a4b4dc0203d7d014f1a6c060afa">range</a>;</div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#af6fec8e2fa06d71775f39b936d3917fb">  198</a></span>&#160;  TA::math::GemmHelper <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#af6fec8e2fa06d71775f39b936d3917fb">gemm_helper</a>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ace86a8e62ed5f4acd766d365bc24d00e">  200</a></span>&#160;  <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ace86a8e62ed5f4acd766d365bc24d00e">DFTaskGemm</a>(<span class="keyword">const</span> TA::Range &amp;<a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a2d6a2a4b4dc0203d7d014f1a6c060afa">range</a>, <span class="keyword">const</span> TA::math::GemmHelper &amp;helper)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      : <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a2d6a2a4b4dc0203d7d014f1a6c060afa">range</a>(<a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a2d6a2a4b4dc0203d7d014f1a6c060afa">range</a>), <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#af6fec8e2fa06d71775f39b936d3917fb">gemm_helper</a>(helper) {}</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#adf5a3465e3bb977d97abb7bf258db273">  203</a></span>&#160;  <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">result_type</a> <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#adf5a3465e3bb977d97abb7bf258db273">operator()</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Tile(<a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a2d6a2a4b4dc0203d7d014f1a6c060afa">range</a>, 0.0); }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a952f1282fd1bbb5ce417e23eb5ee17fb">  205</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">result_type</a> &amp;<a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a952f1282fd1bbb5ce417e23eb5ee17fb">operator()</a>(<span class="keyword">const</span> <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">result_type</a> &amp;result)<span class="keyword"> const </span>{</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#aa25b4592a84acc7c980dbe8c8129b31b">  209</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#aa25b4592a84acc7c980dbe8c8129b31b">add</a>(<a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">result_type</a> &amp;result, <span class="keyword">const</span> <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">result_type</a> &amp;arg)<span class="keyword"> const </span>{</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    TA::math::inplace_vector_op_serial(</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        [](TA::detail::numeric_t&lt;Tile&gt; &amp;l,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;           <span class="keyword">const</span> TA::detail::numeric_t&lt;Tile&gt; r) { l += r; },</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        result.range().volume(), result.data(), arg.data());</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a43afc1bd03d0001705c7c98fffe94797">  216</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a43afc1bd03d0001705c7c98fffe94797">operator()</a>(<a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">result_type</a> &amp;result, <span class="keyword">const</span> <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">result_type</a> &amp;arg)<span class="keyword"> const </span>{</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#aa25b4592a84acc7c980dbe8c8129b31b">add</a>(result, arg);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a0269c8ca6efe644857a9eaea3f93747b">  220</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a0269c8ca6efe644857a9eaea3f93747b">operator()</a>(<a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">result_type</a> &amp;result, <span class="keyword">const</span> <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ac908fe243db7cd9812edbaddea40c07a">first_argument_type</a> &amp;first,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                  <span class="keyword">const</span> <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ab10c601159d8c534e2b06fd84621621c">second_argument_type</a> &amp;second)<span class="keyword"> const </span>{</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    Tile tmp = first.gemm(second, 1.0, <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#af6fec8e2fa06d71775f39b936d3917fb">gemm_helper</a>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#aa25b4592a84acc7c980dbe8c8129b31b">add</a>(result, tmp);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;};</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tile, <span class="keyword">typename</span> Policy&gt;</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html">  228</a></span>&#160;<span class="keyword">class </span><a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html">DirectDFIntegralBuilder</a> : <span class="keyword">public</span> std::enable_shared_from_this&lt;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                    DirectDFIntegralBuilder&lt;Tile, Policy&gt;&gt; {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// constructor</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#a7ded5cc8b206172f9529897137d761fd">DirectDFIntegralBuilder</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#ac4e5cafc1908705a980fb21dee34c96a">  233</a></span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#ac4e5cafc1908705a980fb21dee34c96a">DirectDFIntegralBuilder</a>(</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keyword">const</span> TA::DistArray&lt;Tile, Policy&gt; &amp;left,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keyword">const</span> TA::DistArray&lt;Tile, Policy&gt; &amp;right,</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <a class="code" href="classmpqc_1_1_formula.html#aec6c695225b1faf8e8851b04e62279e3">Formula::Notation</a> notation = <a class="code" href="classmpqc_1_1_formula.html#aec6c695225b1faf8e8851b04e62279e3af5b28c5994e6d7ab604ddcd503be7fc0">Formula::Notation::Chemical</a>)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      : bra_(left),</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        ket_(right),</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        id_(left.world().register_ptr(this)),</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        notation_(notation) {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    df_lobound_ = bra_.trange().data().front().tiles_range().first;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    df_upbound_ = bra_.trange().data().front().tiles_range().second;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    TA_ASSERT(df_lobound_ == ket_.trange().data().front().tiles_range().first);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    TA_ASSERT(df_upbound_ == ket_.trange().data().front().tiles_range().second);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#a7ded5cc8b206172f9529897137d761fd">DirectDFIntegralBuilder</a>(<a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html">DirectDFIntegralBuilder</a> &amp;&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#a7ded5cc8b206172f9529897137d761fd">DirectDFIntegralBuilder</a>(<span class="keyword">const</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html">DirectDFIntegralBuilder</a> &amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html">DirectDFIntegralBuilder</a> &amp;<a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#a09079b99d9f7982f744b15934f576c16">operator=</a>(<span class="keyword">const</span> <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html">DirectDFIntegralBuilder</a> &amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#aa54adc2c1d9fc4efa208527245f69f15">  252</a></span>&#160;  <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#aa54adc2c1d9fc4efa208527245f69f15">~DirectDFIntegralBuilder</a>() {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span> (madness::initialized()) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      madness::World *world = madness::World::world_from_id(id_.get_world_id());</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      world-&gt;unregister_ptr(<span class="keyword">this</span>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#aa0c9fe49c31641f70a36ffe5b97617e6">  259</a></span>&#160;  madness::uniqueidT <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#aa0c9fe49c31641f70a36ffe5b97617e6">id</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> id_; }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">// compute Tile for particular block</span></div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#a2de063c0c2c39ae44b7b628c860cbd0c">  262</a></span>&#160;  madness::Future&lt;Tile&gt; <a class="code" href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#a2de063c0c2c39ae44b7b628c860cbd0c">operator()</a>(<span class="keyword">const</span> std::vector&lt;std::size_t&gt; &amp;idx,</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                   <span class="keyword">const</span> TA::Range &amp;range)<span class="keyword"> const </span>{</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    TA_ASSERT(idx.size() == 4);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keyword">auto</span> &amp;world = bra_.world();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// create tile</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">//    madness::Future&lt;Tile&gt; result(Tile(range, 0.0));</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">//        Tile result(range, 0.0);</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    std::vector&lt;std::size_t&gt; bra_idx(3);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    std::vector&lt;std::size_t&gt; ket_idx(3);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    bra_idx[1] = idx[0];</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    ket_idx[2] = idx[3];</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span> (notation_ == <a class="code" href="classmpqc_1_1_formula.html#aec6c695225b1faf8e8851b04e62279e3ace898d62ed9ca7653a01fe0c781e97e9">Formula::Notation::Physical</a>) {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      bra_idx[2] = idx[2];</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      ket_idx[1] = idx[1];</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      bra_idx[2] = idx[1];</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      ket_idx[1] = idx[2];</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    TA::math::GemmHelper gemm_helper(madness::cblas::Trans,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                     madness::cblas::NoTrans, 4, 3, 3);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    TA::Range this_range;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (notation_ == <a class="code" href="classmpqc_1_1_formula.html#aec6c695225b1faf8e8851b04e62279e3ace898d62ed9ca7653a01fe0c781e97e9">Formula::Notation::Physical</a>) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      this_range = TA::Range(<a class="code" href="tensor__fwd_8h.html#aecc9b6cf0e6a7f03eff04f5ecf9a7e5c">TA::Permutation</a>({0, 2, 1, 3}), range);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      this_range = range;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <a class="code" href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html">DFTaskGemm&lt;Tile&gt;</a> task_gemm(this_range, gemm_helper);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    TA::detail::ReducePairTask&lt;decltype(task_gemm)&gt; reduce_pair_task(world,</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                                                     task_gemm);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// loop over density fitting space</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">for</span> (std::size_t i = df_lobound_; i &lt; df_upbound_; ++i) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      bra_idx[0] = i;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      ket_idx[0] = i;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      madness::Future&lt;Tile&gt; future_bra_tile = bra_.find(bra_idx);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      madness::Future&lt;Tile&gt; future_ket_tile = ket_.find(ket_idx);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      reduce_pair_task.add(future_bra_tile, future_ket_tile);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// permute function</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacempqc_1_1math.html#a9c26202314ed97185c6672e41dcd6279">permute</a> = [](<span class="keyword">const</span> Tile &amp;tile) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">return</span> tile.permute(<a class="code" href="tensor__fwd_8h.html#aecc9b6cf0e6a7f03eff04f5ecf9a7e5c">TA::Permutation</a>({0, 2, 1, 3}));</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    };</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> (notation_ == <a class="code" href="classmpqc_1_1_formula.html#aec6c695225b1faf8e8851b04e62279e3af5b28c5994e6d7ab604ddcd503be7fc0">Formula::Notation::Chemical</a>) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">return</span> reduce_pair_task.submit();</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">return</span> world.taskq.add(<a class="code" href="namespacempqc_1_1math.html#a9c26202314ed97185c6672e41dcd6279">permute</a>, reduce_pair_task.submit());</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; <span class="keyword">private</span>:</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// left hand size three center integral</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  TA::DistArray&lt;Tile, Policy&gt; bra_;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="comment">// right hand size three center integral</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  TA::DistArray&lt;Tile, Policy&gt; ket_;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// low bound for density fitting dimension, should be zero</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  std::size_t df_lobound_;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="comment">// up bound for density fitting dimension, should be the max</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  std::size_t df_upbound_;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">// madness id for serailization</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  madness::uniqueidT id_;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// notation</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="classmpqc_1_1_formula.html#aec6c695225b1faf8e8851b04e62279e3">Formula::Notation</a> notation_;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;};</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tile, <span class="keyword">typename</span> Engine&gt;</div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="namespacempqc_1_1lcao_1_1gaussian.html#aa0f9517f99e4cc3ff235f5ebeb6e8611">  339</a></span>&#160;std::shared_ptr&lt;IntegralBuilder&lt;Tile, Engine&gt;&gt; <a class="code" href="namespacempqc_1_1lcao_1_1gaussian.html#aa0f9517f99e4cc3ff235f5ebeb6e8611">make_integral_builder</a>(</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="namespacempqc_1_1lcao_1_1gaussian.html#a1e7d958d02e65d2ec20148f6a70d3b79">ShrPool&lt;Engine&gt;</a> shr_epool, std::shared_ptr&lt;BasisVector&gt; shr_bases,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    std::shared_ptr&lt;Screener&gt; shr_screen,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    std::function&lt;Tile(TA::TensorD &amp;&amp;)&gt; op,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    std::shared_ptr&lt;const math::PetiteList&gt; plist =</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <a class="code" href="classmpqc_1_1math_1_1_petite_list.html#a4610f62d3211547339fc74f219ff04b2">math::PetiteList::make_trivial</a>()) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">return</span> std::make_shared&lt;IntegralBuilder&lt;Tile, Engine&gt;&gt;(</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      std::move(shr_epool), std::move(shr_bases), std::move(shr_screen),</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      std::move(op), std::move(plist));</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tile, <span class="keyword">typename</span> Engine&gt;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;std::shared_ptr&lt;DirectIntegralBuilder&lt;Tile, Engine&gt;&gt;</div><div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="namespacempqc_1_1lcao_1_1gaussian.html#a2508155a80fbffb9eb047b12b6e96b74">  356</a></span>&#160;<a class="code" href="namespacempqc_1_1lcao_1_1gaussian.html#a2508155a80fbffb9eb047b12b6e96b74">make_direct_integral_builder</a>(madness::World &amp;world, <a class="code" href="namespacempqc_1_1lcao_1_1gaussian.html#a1e7d958d02e65d2ec20148f6a70d3b79">ShrPool&lt;Engine&gt;</a> shr_epool,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                             std::shared_ptr&lt;BasisVector&gt; shr_bases,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                             std::shared_ptr&lt;Screener&gt; shr_screen,</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                             std::function&lt;Tile(TA::TensorD &amp;&amp;)&gt; op,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                             std::shared_ptr&lt;const math::PetiteList&gt; plist =</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                 <a class="code" href="classmpqc_1_1math_1_1_petite_list.html#a4610f62d3211547339fc74f219ff04b2">math::PetiteList::make_trivial</a>()) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordflow">return</span> std::make_shared&lt;DirectIntegralBuilder&lt;Tile, Engine&gt;&gt;(</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      world, std::move(shr_epool), std::move(shr_bases), std::move(shr_screen),</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      std::move(op), std::move(plist));</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}  <span class="comment">// namespace gaussian</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}  <span class="comment">// namespace lcao</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}  <span class="comment">// namespace mpqc</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">#endif  // MPQC4_SRC_MPQC_CHEMISTRY_QC_INTEGRALS_INTEGRAL_BUILDER_H_</span></div><div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_a0269c8ca6efe644857a9eaea3f93747b"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a0269c8ca6efe644857a9eaea3f93747b">mpqc::lcao::gaussian::DFTaskGemm::operator()</a></div><div class="ttdeci">void operator()(result_type &amp;result, const first_argument_type &amp;first, const second_argument_type &amp;second) const</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00220">integral_builder.h:220</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_ac908fe243db7cd9812edbaddea40c07a"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ac908fe243db7cd9812edbaddea40c07a">mpqc::lcao::gaussian::DFTaskGemm::first_argument_type</a></div><div class="ttdeci">Tile first_argument_type</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00194">integral_builder.h:194</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_af6fec8e2fa06d71775f39b936d3917fb"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#af6fec8e2fa06d71775f39b936d3917fb">mpqc::lcao::gaussian::DFTaskGemm::gemm_helper</a></div><div class="ttdeci">TA::math::GemmHelper gemm_helper</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00198">integral_builder.h:198</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder_html_a7ded5cc8b206172f9529897137d761fd"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#a7ded5cc8b206172f9529897137d761fd">mpqc::lcao::gaussian::DirectDFIntegralBuilder::DirectDFIntegralBuilder</a></div><div class="ttdeci">DirectDFIntegralBuilder()=default</div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder_html_a09079b99d9f7982f744b15934f576c16"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#a09079b99d9f7982f744b15934f576c16">mpqc::lcao::gaussian::DirectDFIntegralBuilder::operator=</a></div><div class="ttdeci">DirectDFIntegralBuilder &amp; operator=(const DirectDFIntegralBuilder &amp;)=delete</div></div>
<div class="ttc" id="pool_8h_html"><div class="ttname"><a href="pool_8h.html">pool.h</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_ab10c601159d8c534e2b06fd84621621c"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ab10c601159d8c534e2b06fd84621621c">mpqc::lcao::gaussian::DFTaskGemm::second_argument_type</a></div><div class="ttdeci">Tile second_argument_type</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00195">integral_builder.h:195</a></div></div>
<div class="ttc" id="classmpqc_1_1_formula_html_aec6c695225b1faf8e8851b04e62279e3af5b28c5994e6d7ab604ddcd503be7fc0"><div class="ttname"><a href="classmpqc_1_1_formula.html#aec6c695225b1faf8e8851b04e62279e3af5b28c5994e6d7ab604ddcd503be7fc0">mpqc::Formula::Notation::Chemical</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder_html_aa54adc2c1d9fc4efa208527245f69f15"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#aa54adc2c1d9fc4efa208527245f69f15">mpqc::lcao::gaussian::DirectDFIntegralBuilder::~DirectDFIntegralBuilder</a></div><div class="ttdeci">~DirectDFIntegralBuilder()</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00252">integral_builder.h:252</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder_html_aa0c9fe49c31641f70a36ffe5b97617e6"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#aa0c9fe49c31641f70a36ffe5b97617e6">mpqc::lcao::gaussian::DirectDFIntegralBuilder::id</a></div><div class="ttdeci">madness::uniqueidT id() const</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00259">integral_builder.h:259</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html">mpqc::lcao::gaussian::DFTaskGemm</a></div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00192">integral_builder.h:192</a></div></div>
<div class="ttc" id="exception_8h_html"><div class="ttname"><a href="exception_8h.html">exception.h</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder_html_ac47d5b2cf0b069a9cb7717b8b3efdf6a"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ac47d5b2cf0b069a9cb7717b8b3efdf6a">mpqc::lcao::gaussian::IntegralBuilder::~IntegralBuilder</a></div><div class="ttdeci">virtual ~IntegralBuilder()</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00072">integral_builder.h:72</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_aa25b4592a84acc7c980dbe8c8129b31b"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#aa25b4592a84acc7c980dbe8c8129b31b">mpqc::lcao::gaussian::DFTaskGemm::add</a></div><div class="ttdeci">void add(result_type &amp;result, const result_type &amp;arg) const</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00209">integral_builder.h:209</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder_html_a06695fd049af322840dc86f637348cf0"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#a06695fd049af322840dc86f637348cf0">mpqc::lcao::gaussian::DirectIntegralBuilder::~DirectIntegralBuilder</a></div><div class="ttdeci">~DirectIntegralBuilder()</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00176">integral_builder.h:176</a></div></div>
<div class="ttc" id="petite__list_8h_html"><div class="ttname"><a href="petite__list_8h.html">petite_list.h</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_ad5961f300ac530fd9d355b28ef82f485"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ad5961f300ac530fd9d355b28ef82f485">mpqc::lcao::gaussian::DFTaskGemm::result_type</a></div><div class="ttdeci">Tile result_type</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00193">integral_builder.h:193</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_html_aa0f9517f99e4cc3ff235f5ebeb6e8611"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian.html#aa0f9517f99e4cc3ff235f5ebeb6e8611">mpqc::lcao::gaussian::make_integral_builder</a></div><div class="ttdeci">std::shared_ptr&lt; IntegralBuilder&lt; Tile, Engine &gt; &gt; make_integral_builder(ShrPool&lt; Engine &gt; shr_epool, std::shared_ptr&lt; BasisVector &gt; shr_bases, std::shared_ptr&lt; Screener &gt; shr_screen, std::function&lt; Tile(TA::TensorD &amp;&amp;)&gt; op, std::shared_ptr&lt; const math::PetiteList &gt; plist=math::PetiteList::make_trivial())</div><div class="ttdoc">Function to make detection of template parameters easier, see IntegralBuilder for details...</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00339">integral_builder.h:339</a></div></div>
<div class="ttc" id="namespacempqc_html"><div class="ttname"><a href="namespacempqc.html">mpqc</a></div><div class="ttdoc">This file contains functions to compute effective Hamiltonian of CCSD. </div><div class="ttdef"><b>Definition:</b> <a href="libmpqc_8cpp_source.html#l00001">libmpqc.cpp:1</a></div></div>
<div class="ttc" id="classmpqc_1_1math_1_1_petite_list_html_a4610f62d3211547339fc74f219ff04b2"><div class="ttname"><a href="classmpqc_1_1math_1_1_petite_list.html#a4610f62d3211547339fc74f219ff04b2">mpqc::math::PetiteList::make_trivial</a></div><div class="ttdeci">static std::shared_ptr&lt; const PetiteList &gt; make_trivial()</div><div class="ttdef"><b>Definition:</b> <a href="petite__list_8cpp_source.html#l00027">petite_list.cpp:27</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder_html_aaa4caf00f45d0e3f66cb815904b043bb"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#aaa4caf00f45d0e3f66cb815904b043bb">mpqc::lcao::gaussian::DirectIntegralBuilder::DirectIntegralBuilder</a></div><div class="ttdeci">DirectIntegralBuilder(madness::World &amp;world, ShrPool&lt; Engine &gt; shr_epool, std::shared_ptr&lt; BasisVector &gt; shr_bases, std::shared_ptr&lt; Screener &gt; screen, Op op, std::shared_ptr&lt; const math::PetiteList &gt; plist)</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00163">integral_builder.h:163</a></div></div>
<div class="ttc" id="basis_8h_html"><div class="ttname"><a href="basis_8h.html">basis.h</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_ace86a8e62ed5f4acd766d365bc24d00e"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#ace86a8e62ed5f4acd766d365bc24d00e">mpqc::lcao::gaussian::DFTaskGemm::DFTaskGemm</a></div><div class="ttdeci">DFTaskGemm(const TA::Range &amp;range, const TA::math::GemmHelper &amp;helper)</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00200">integral_builder.h:200</a></div></div>
<div class="ttc" id="classmpqc_1_1_feature_not_implemented_html"><div class="ttname"><a href="classmpqc_1_1_feature_not_implemented.html">mpqc::FeatureNotImplemented</a></div><div class="ttdef"><b>Definition:</b> <a href="exception_8h_source.html#l00160">exception.h:160</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder_html_a2356f48131a57c708ccdb9cb51aba543"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#a2356f48131a57c708ccdb9cb51aba543">mpqc::lcao::gaussian::DirectIntegralBuilder::id</a></div><div class="ttdeci">madness::uniqueidT id() const</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00174">integral_builder.h:174</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder_html"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html">mpqc::lcao::gaussian::DirectIntegralBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00157">integral_builder.h:157</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_html_a2508155a80fbffb9eb047b12b6e96b74"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian.html#a2508155a80fbffb9eb047b12b6e96b74">mpqc::lcao::gaussian::make_direct_integral_builder</a></div><div class="ttdeci">std::shared_ptr&lt; DirectIntegralBuilder&lt; Tile, Engine &gt; &gt; make_direct_integral_builder(madness::World &amp;world, ShrPool&lt; Engine &gt; shr_epool, std::shared_ptr&lt; BasisVector &gt; shr_bases, std::shared_ptr&lt; Screener &gt; shr_screen, std::function&lt; Tile(TA::TensorD &amp;&amp;)&gt; op, std::shared_ptr&lt; const math::PetiteList &gt; plist=math::PetiteList::make_trivial())</div><div class="ttdoc">Function to make detection of template parameters easier, see DirectIntegralBuilder for details...</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00356">integral_builder.h:356</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_1_1detail_html_addf897b013e32d9f443067ba5fad241d"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">mpqc::lcao::gaussian::detail::Engine</a></div><div class="ttdeci">libint2::Engine Engine</div><div class="ttdef"><b>Definition:</b> <a href="task__integral__kernels_8h_source.html#l00025">task_integral_kernels.h:25</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_1_1detail_html_a63a00d2fcba7079aa59feb52ebea79a4"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a63a00d2fcba7079aa59feb52ebea79a4">mpqc::lcao::gaussian::detail::integral_kernel</a></div><div class="ttdeci">TA::TensorD integral_kernel(Engine &amp;eng, TA::Range &amp;&amp;rng, std::array&lt; ShellVec const *, 2 &gt; shell_ptrs, Screener &amp;, const math::PetiteList &amp;plist)</div><div class="ttdoc">This computes an std::array of integrals for operators that have nopers components, e.g. multipole moments, geometrical derivatives, etc. Note that only one tile is computed for each component, and all nopers tiles share the same index and range. </div><div class="ttdef"><b>Definition:</b> <a href="task__integral__kernels_8cpp_source.html#l00014">task_integral_kernels.cpp:14</a></div></div>
<div class="ttc" id="tiledarray_8h_html"><div class="ttname"><a href="tiledarray_8h.html">tiledarray.h</a></div></div>
<div class="ttc" id="qc_2lcao_2expression_2formula_8h_html"><div class="ttname"><a href="qc_2lcao_2expression_2formula_8h.html">formula.h</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_adf5a3465e3bb977d97abb7bf258db273"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#adf5a3465e3bb977d97abb7bf258db273">mpqc::lcao::gaussian::DFTaskGemm::operator()</a></div><div class="ttdeci">result_type operator()() const</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00203">integral_builder.h:203</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_a2d6a2a4b4dc0203d7d014f1a6c060afa"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a2d6a2a4b4dc0203d7d014f1a6c060afa">mpqc::lcao::gaussian::DFTaskGemm::range</a></div><div class="ttdeci">TA::Range range</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00197">integral_builder.h:197</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder_html_ab48277f001f66d509a46761e84933e1d"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ab48277f001f66d509a46761e84933e1d">mpqc::lcao::gaussian::IntegralBuilder::op</a></div><div class="ttdeci">Tile op(TA::TensorD &amp;&amp;tensor)</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00153">integral_builder.h:153</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_a952f1282fd1bbb5ce417e23eb5ee17fb"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a952f1282fd1bbb5ce417e23eb5ee17fb">mpqc::lcao::gaussian::DFTaskGemm::operator()</a></div><div class="ttdeci">const result_type &amp; operator()(const result_type &amp;result) const</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00205">integral_builder.h:205</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder_html_aa633ff3dd8fe6951d1de9fbcd4d7f899"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#aa633ff3dd8fe6951d1de9fbcd4d7f899">mpqc::lcao::gaussian::IntegralBuilder::operator()</a></div><div class="ttdeci">Tile operator()(std::vector&lt; std::size_t &gt; const &amp;idx, TA::Range range)</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00074">integral_builder.h:74</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder_html"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html">mpqc::lcao::gaussian::DirectDFIntegralBuilder</a></div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00228">integral_builder.h:228</a></div></div>
<div class="ttc" id="classmpqc_1_1_formula_html_aec6c695225b1faf8e8851b04e62279e3ace898d62ed9ca7653a01fe0c781e97e9"><div class="ttname"><a href="classmpqc_1_1_formula.html#aec6c695225b1faf8e8851b04e62279e3ace898d62ed9ca7653a01fe0c781e97e9">mpqc::Formula::Notation::Physical</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder_html_a2de063c0c2c39ae44b7b628c860cbd0c"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#a2de063c0c2c39ae44b7b628c860cbd0c">mpqc::lcao::gaussian::DirectDFIntegralBuilder::operator()</a></div><div class="ttdeci">madness::Future&lt; Tile &gt; operator()(const std::vector&lt; std::size_t &gt; &amp;idx, const TA::Range &amp;range) const</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00262">integral_builder.h:262</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_1_1detail_html_abb0ef0fdc99469d480fd911185ea497e"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#abb0ef0fdc99469d480fd911185ea497e">mpqc::lcao::gaussian::detail::VecArray</a></div><div class="ttdeci">std::array&lt; ShellVec const *, N &gt; VecArray</div><div class="ttdef"><b>Definition:</b> <a href="task__integrals__common_8h_source.html#l00040">task_integrals_common.h:40</a></div></div>
<div class="ttc" id="screen__base_8h_html"><div class="ttname"><a href="screen__base_8h.html">screen_base.h</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder_html_ad62fb6db3c7bc7a89db9aac74138f50e"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ad62fb6db3c7bc7a89db9aac74138f50e">mpqc::lcao::gaussian::IntegralBuilder::Op</a></div><div class="ttdeci">std::function&lt; Tile(TA::TensorD &amp;&amp;)&gt; Op</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00036">integral_builder.h:36</a></div></div>
<div class="ttc" id="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm_html_a43afc1bd03d0001705c7c98fffe94797"><div class="ttname"><a href="structmpqc_1_1lcao_1_1gaussian_1_1_d_f_task_gemm.html#a43afc1bd03d0001705c7c98fffe94797">mpqc::lcao::gaussian::DFTaskGemm::operator()</a></div><div class="ttdeci">void operator()(result_type &amp;result, const result_type &amp;arg) const</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00216">integral_builder.h:216</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_html_a1e7d958d02e65d2ec20148f6a70d3b79"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian.html#a1e7d958d02e65d2ec20148f6a70d3b79">mpqc::lcao::gaussian::ShrPool</a></div><div class="ttdeci">std::shared_ptr&lt; mpqc::utility::TSPool&lt; E &gt; &gt; ShrPool</div><div class="ttdef"><b>Definition:</b> <a href="task__integrals__common_8h_source.html#l00025">task_integrals_common.h:25</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder_html_a36a168825fbd4247ec136a7e4e1b7ab7"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#a36a168825fbd4247ec136a7e4e1b7ab7">mpqc::lcao::gaussian::IntegralBuilder::IntegralBuilder</a></div><div class="ttdeci">IntegralBuilder(ShrPool&lt; Engine &gt; shr_epool, std::shared_ptr&lt; BasisVector &gt; shr_bases, std::shared_ptr&lt; Screener &gt; screen, Op op, std::shared_ptr&lt; const math::PetiteList &gt; plist=math::PetiteList::make_trivial())</div><div class="ttdoc">Constructor which copies all shared_ptr members. </div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00058">integral_builder.h:58</a></div></div>
<div class="ttc" id="task__integral__kernels_8h_html"><div class="ttname"><a href="task__integral__kernels_8h.html">task_integral_kernels.h</a></div></div>
<div class="ttc" id="task__integrals__common_8h_html"><div class="ttname"><a href="task__integrals__common_8h.html">task_integrals_common.h</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder_html"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html">mpqc::lcao::gaussian::IntegralBuilder</a></div><div class="ttdoc">Builds integrals from an array of bases and an integral engine pool. </div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00034">integral_builder.h:34</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder_html_ae4ce62e2cabcbdb95afdbf42f3d50081"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#ae4ce62e2cabcbdb95afdbf42f3d50081">mpqc::lcao::gaussian::IntegralBuilder::integrals</a></div><div class="ttdeci">TA::TensorD integrals(std::vector&lt; std::size_t &gt; const &amp;idx, TA::Range range)</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00078">integral_builder.h:78</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder_html_ac4e5cafc1908705a980fb21dee34c96a"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_d_f_integral_builder.html#ac4e5cafc1908705a980fb21dee34c96a">mpqc::lcao::gaussian::DirectDFIntegralBuilder::DirectDFIntegralBuilder</a></div><div class="ttdeci">DirectDFIntegralBuilder(const TA::DistArray&lt; Tile, Policy &gt; &amp;left, const TA::DistArray&lt; Tile, Policy &gt; &amp;right, Formula::Notation notation=Formula::Notation::Chemical)</div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00233">integral_builder.h:233</a></div></div>
<div class="ttc" id="tensor__fwd_8h_html_aecc9b6cf0e6a7f03eff04f5ecf9a7e5c"><div class="ttname"><a href="tensor__fwd_8h.html#aecc9b6cf0e6a7f03eff04f5ecf9a7e5c">Permutation</a></div><div class="ttdeci">TA::Permutation Permutation</div><div class="ttdef"><b>Definition:</b> <a href="tensor__fwd_8h_source.html#l00008">tensor_fwd.h:8</a></div></div>
<div class="ttc" id="classmpqc_1_1_formula_html_aec6c695225b1faf8e8851b04e62279e3"><div class="ttname"><a href="classmpqc_1_1_formula.html#aec6c695225b1faf8e8851b04e62279e3">mpqc::Formula::Notation</a></div><div class="ttdeci">Notation</div><div class="ttdoc">Types of Notation. </div><div class="ttdef"><b>Definition:</b> <a href="qc_2lcao_2expression_2formula_8h_source.html#l00048">formula.h:48</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder_html_a57b6fffec281837d11dacc21ff03b02d"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_integral_builder.html#a57b6fffec281837d11dacc21ff03b02d">mpqc::lcao::gaussian::IntegralBuilder::integrals</a></div><div class="ttdeci">std::array&lt; TA::TensorD, libint2::operator_traits&lt; libint2_oper &gt;::nopers &gt; integrals(std::vector&lt; std::size_t &gt; const &amp;idx, TA::Range range)</div><div class="ttdoc">This computes an std::array of integrals for operators that have nopers components, e.g. multipole moments, geometrical derivatives, etc. Note that only one tile is computed for each component, and all nopers tiles share the same index and range. </div><div class="ttdef"><b>Definition:</b> <a href="integral__builder_8h_source.html#l00131">integral_builder.h:131</a></div></div>
<div class="ttc" id="namespacempqc_1_1math_html_a9c26202314ed97185c6672e41dcd6279"><div class="ttname"><a href="namespacempqc_1_1math.html#a9c26202314ed97185c6672e41dcd6279">mpqc::math::permute</a></div><div class="ttdeci">DecomposedTensor&lt; T &gt; permute(DecomposedTensor&lt; T &gt; const &amp;t, TA::Permutation const &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="decomposed__tensor__unary_8h_source.html#l00087">decomposed_tensor_unary.h:87</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder_html_a6f6fdcedc22f5c8e7209f39e4f253f08"><div class="ttname"><a href="classmpqc_1_1lcao_1_1gaussian_1_1_direct_integral_builder.html#a6f6fdcedc22f5c8e7209f39e4f253f08">mpqc::lcao::gaussian::DirectIntegralBuilder::operator=</a></div><div class="ttdeci">DirectIntegralBuilder &amp; operator=(const DirectIntegralBuilder &amp;builder)=delete</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<address>
<small>
Generated at Mon Aug 27 2018 08:29:36 for <a
href="http://www.mpqc.org">MPQC</a>
4.0.0-beta.1 using the documentation package <a
href="http://www.doxygen.org">Doxygen</a>
1.8.14.
</small>
</address>
</body>
</html>
