<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MPQC: mpqc/chemistry/qc/lcao/integrals/task_integral_kernels.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MPQC
   &#160;<span id="projectnumber">4.0.0-beta.1</span>
   </div>
   <div id="projectbrief">Massively Parallel Electronic Structure platform</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('task__integral__kernels_8h_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">task_integral_kernels.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="task__integral__kernels_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// task_integrals_helper.h</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Copyright (C) 2015 Drew Lewis</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Maintainer Drew Lewis</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#ifndef MPQC4_SRC_MPQC_CHEMISTRY_QC_INTEGRALS_TASK_INTEGRAL_KERNELS_H_</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#define MPQC4_SRC_MPQC_CHEMISTRY_QC_INTEGRALS_TASK_INTEGRAL_KERNELS_H_</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;libint2/engine.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="tiledarray_8h.html">tiledarray.h</a>&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="screen__base_8h.html">mpqc/chemistry/qc/lcao/integrals/screening/screen_base.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="task__integrals__common_8h.html">mpqc/chemistry/qc/lcao/integrals/task_integrals_common.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="petite__list_8h.html">mpqc/math/groups/petite_list.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacempqc.html">mpqc</a> {</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">namespace </span>lcao {</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">namespace </span>gaussian {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">namespace </span>detail {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#ab6450ebaf8c4b74ed07a22bd07d12849">integral_engine_precision</a>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">   25</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">Engine</a> = <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">libint2::Engine</a>;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a84a382215bfa953c59fd66489fa8e519">   26</a></span>&#160;<span class="keyword">using</span> <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a84a382215bfa953c59fd66489fa8e519">data_pointer</a> = TA::TensorD::pointer;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a7cade63b4e4157e22c8ffbc87be0ca76">   28</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a7cade63b4e4157e22c8ffbc87be0ca76">set_eng_precision</a>(<a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">Engine</a> &amp;eng) {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  eng.set_precision(<a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#ab6450ebaf8c4b74ed07a22bd07d12849">integral_engine_precision</a>);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;}</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Shells&gt;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#ace94622080cc81a564748e3294838208">   33</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#ace94622080cc81a564748e3294838208">shell_set</a>(<a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">Engine</a> &amp;e, Shells &amp;&amp;... shells) {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  e.compute(std::forward&lt;Shells&gt;(shells)...);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;TA::TensorD <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a63a00d2fcba7079aa59feb52ebea79a4">integral_kernel</a>(<a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">Engine</a> &amp;eng, TA::Range &amp;&amp;rng,</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                            std::array&lt;ShellVec const *, 2&gt; shell_ptrs,</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                            <a class="code" href="classmpqc_1_1lcao_1_1_screener.html">Screener</a> &amp;screen, <span class="keyword">const</span> math::PetiteList &amp;plist);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;TA::TensorD <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a63a00d2fcba7079aa59feb52ebea79a4">integral_kernel</a>(<a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">Engine</a> &amp;eng, TA::Range &amp;&amp;rng,</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                            std::array&lt;ShellVec const *, 3&gt; shell_ptrs,</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                            <a class="code" href="classmpqc_1_1lcao_1_1_screener.html">Screener</a> &amp;screen, <span class="keyword">const</span> math::PetiteList &amp;plist);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;TA::TensorD <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a63a00d2fcba7079aa59feb52ebea79a4">integral_kernel</a>(<a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">Engine</a> &amp;eng, TA::Range &amp;&amp;rng,</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                            std::array&lt;ShellVec const *, 4&gt; shell_ptrs,</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                            <a class="code" href="classmpqc_1_1lcao_1_1_screener.html">Screener</a> &amp;screen, <span class="keyword">const</span> math::PetiteList &amp;plist);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">template</span> &lt;lib<span class="keywordtype">int</span>2::Operator lib<span class="keywordtype">int</span>2_oper&gt;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;std::array&lt;TA::TensorD, libint2::operator_traits&lt;libint2_oper&gt;::nopers&gt;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a63a00d2fcba7079aa59feb52ebea79a4">integral_kernel</a>(<a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">Engine</a> &amp;eng, TA::Range &amp;&amp;rng,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                std::array&lt;ShellVec const *, 2&gt; shell_ptrs, <a class="code" href="classmpqc_1_1lcao_1_1_screener.html">Screener</a> &amp;screen,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <span class="keyword">const</span> math::PetiteList &amp;plist) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a7cade63b4e4157e22c8ffbc87be0ca76">set_eng_precision</a>(eng);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp;lobound = rng.lobound();</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// get the index of the first basis function in each cluster</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> basis_func_offset_cluster0 = lobound[0];</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> basis_func_offset_cluster1 = lobound[1];</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// get reference to clusters (ShellVec type)</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp;shvec0 = *shell_ptrs[0];</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keyword">auto</span> <span class="keyword">const</span> &amp;shvec1 = *shell_ptrs[1];</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// get the total number of shells in each cluster</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> nshells0 = shvec0.size();</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> nshells1 = shvec1.size();</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// get the total number of basis functions in the second cluster</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keyword">auto</span> ext_c1 = rng.extent_data()[1];</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">// create the result tiles</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keyword">using</span> ResultType =</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      std::array&lt;TA::TensorD, libint2::operator_traits&lt;libint2_oper&gt;::nopers&gt;;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  ResultType result;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;tile : result) {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    tile = TA::TensorD(rng, 0.0);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">// grab pointers to the result tiles to make addressing more efficient</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keyword">using</span> ResultPtrType =</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      std::array&lt;data_pointer, libint2::operator_traits&lt;libint2_oper&gt;::nopers&gt;;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  ResultPtrType array_of_tile_ptr0;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> nopers = libint2::operator_traits&lt;libint2_oper&gt;::nopers;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> op = 0u; op != nopers; ++op) {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    array_of_tile_ptr0[op] = result[op].data();</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ints_shell_sets = eng.results();</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// compute integrals</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">auto</span> cf_offset0 = 0u;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keyword">auto</span> bf_offset0 = basis_func_offset_cluster0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> idx_sh0 = 0ul; idx_sh0 &lt; nshells0; ++idx_sh0) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">auto</span> <span class="keyword">const</span> &amp;sh0 = shvec0[idx_sh0];</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> nf0 = sh0.size();</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (plist.is_canonical(bf_offset0)) {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keyword">auto</span> cf_offset1 = 0u;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keyword">auto</span> bf_offset1 = basis_func_offset_cluster1;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> idx_sh1 = 0ul; idx_sh1 &lt; nshells1; ++idx_sh1) {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span> &amp;sh1 = shvec1[idx_sh1];</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> nf1 = sh1.size();</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">if</span> (plist.is_canonical(bf_offset0, bf_offset1)) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          <a class="code" href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#ace94622080cc81a564748e3294838208">shell_set</a>(eng, sh0, sh1);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> permutational_multiplicity =</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;              plist.multiplicity(bf_offset0, bf_offset1);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> op = 0u; op != nopers; ++op) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">if</span> (ints_shell_sets[op] != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;              <span class="keyword">const</span> <span class="keyword">auto</span> *ints_ptr = ints_shell_sets[op];</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;              <span class="keyword">auto</span> *tile_ptr = array_of_tile_ptr0[op];</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> f0 = 0ul, f01 = 0ul; f0 != nf0; ++f0) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> cf1_offset = (f0 + cf_offset0) * ext_c1;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> f1 = 0ul; f1 != nf1; ++f1, ++f01) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                  <span class="keyword">const</span> <span class="keyword">auto</span> cf01 = cf1_offset + f1 + cf_offset1;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                  <span class="keyword">const</span> <span class="keyword">auto</span> mult_int =</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                      permutational_multiplicity * ints_ptr[f01];</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                  tile_ptr[cf01] = mult_int;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;              }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        bf_offset1 += nf1;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        cf_offset1 += nf1;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    bf_offset0 += nf0;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    cf_offset0 += nf0;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;};</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}  <span class="comment">// namespace detail</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}  <span class="comment">// namespace gaussian</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}  <span class="comment">// namespace lcao</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}  <span class="comment">// namespace mpqc</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#endif  // MPQC4_SRC_MPQC_CHEMISTRY_QC_INTEGRALS_TASK_INTEGRAL_KERNELS_H_</span></div><div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_1_1detail_html_ab6450ebaf8c4b74ed07a22bd07d12849"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#ab6450ebaf8c4b74ed07a22bd07d12849">mpqc::lcao::gaussian::detail::integral_engine_precision</a></div><div class="ttdeci">double integral_engine_precision</div><div class="ttdef"><b>Definition:</b> <a href="task__integral__kernels_8cpp_source.html#l00012">task_integral_kernels.cpp:12</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_1_1detail_html_a7cade63b4e4157e22c8ffbc87be0ca76"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a7cade63b4e4157e22c8ffbc87be0ca76">mpqc::lcao::gaussian::detail::set_eng_precision</a></div><div class="ttdeci">void set_eng_precision(Engine &amp;eng)</div><div class="ttdef"><b>Definition:</b> <a href="task__integral__kernels_8h_source.html#l00028">task_integral_kernels.h:28</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_1_1detail_html_a84a382215bfa953c59fd66489fa8e519"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a84a382215bfa953c59fd66489fa8e519">mpqc::lcao::gaussian::detail::data_pointer</a></div><div class="ttdeci">TA::TensorD::pointer data_pointer</div><div class="ttdef"><b>Definition:</b> <a href="task__integral__kernels_8h_source.html#l00026">task_integral_kernels.h:26</a></div></div>
<div class="ttc" id="petite__list_8h_html"><div class="ttname"><a href="petite__list_8h.html">petite_list.h</a></div></div>
<div class="ttc" id="namespacempqc_html"><div class="ttname"><a href="namespacempqc.html">mpqc</a></div><div class="ttdoc">This file contains functions to compute effective Hamiltonian of CCSD. </div><div class="ttdef"><b>Definition:</b> <a href="libmpqc_8cpp_source.html#l00001">libmpqc.cpp:1</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_1_1detail_html_addf897b013e32d9f443067ba5fad241d"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#addf897b013e32d9f443067ba5fad241d">mpqc::lcao::gaussian::detail::Engine</a></div><div class="ttdeci">libint2::Engine Engine</div><div class="ttdef"><b>Definition:</b> <a href="task__integral__kernels_8h_source.html#l00025">task_integral_kernels.h:25</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_1_1detail_html_a63a00d2fcba7079aa59feb52ebea79a4"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#a63a00d2fcba7079aa59feb52ebea79a4">mpqc::lcao::gaussian::detail::integral_kernel</a></div><div class="ttdeci">TA::TensorD integral_kernel(Engine &amp;eng, TA::Range &amp;&amp;rng, std::array&lt; ShellVec const *, 2 &gt; shell_ptrs, Screener &amp;, const math::PetiteList &amp;plist)</div><div class="ttdoc">This computes an std::array of integrals for operators that have nopers components, e.g. multipole moments, geometrical derivatives, etc. Note that only one tile is computed for each component, and all nopers tiles share the same index and range. </div><div class="ttdef"><b>Definition:</b> <a href="task__integral__kernels_8cpp_source.html#l00014">task_integral_kernels.cpp:14</a></div></div>
<div class="ttc" id="namespacempqc_1_1lcao_1_1gaussian_1_1detail_html_ace94622080cc81a564748e3294838208"><div class="ttname"><a href="namespacempqc_1_1lcao_1_1gaussian_1_1detail.html#ace94622080cc81a564748e3294838208">mpqc::lcao::gaussian::detail::shell_set</a></div><div class="ttdeci">void shell_set(Engine &amp;e, Shells &amp;&amp;... shells)</div><div class="ttdef"><b>Definition:</b> <a href="task__integral__kernels_8h_source.html#l00033">task_integral_kernels.h:33</a></div></div>
<div class="ttc" id="tiledarray_8h_html"><div class="ttname"><a href="tiledarray_8h.html">tiledarray.h</a></div></div>
<div class="ttc" id="classmpqc_1_1lcao_1_1_screener_html"><div class="ttname"><a href="classmpqc_1_1lcao_1_1_screener.html">mpqc::lcao::Screener</a></div><div class="ttdoc">Base class for screeners will never skip any integrals. </div><div class="ttdef"><b>Definition:</b> <a href="screen__base_8h_source.html#l00019">screen_base.h:19</a></div></div>
<div class="ttc" id="screen__base_8h_html"><div class="ttname"><a href="screen__base_8h.html">screen_base.h</a></div></div>
<div class="ttc" id="task__integrals__common_8h_html"><div class="ttname"><a href="task__integrals__common_8h.html">task_integrals_common.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr>
<address>
<small>
Generated at Mon Aug 27 2018 08:29:36 for <a
href="http://www.mpqc.org">MPQC</a>
4.0.0-beta.1 using the documentation package <a
href="http://www.doxygen.org">Doxygen</a>
1.8.14.
</small>
</address>
</body>
</html>
